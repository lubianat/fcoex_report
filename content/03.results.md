# Results

## The fcoex method 

The 
The _fcoex_ tool was built bottom up from first principles, with a goal to avoid complicated algorithms and improve understandability. 

Our first goal was to come up with a smaller set of genes that globally captured the diversity of the dataset. 

Instead of using simply the highly variable genes, we decided to explore symmetrical uncertainty, a correlation metric from information theory that is used in the FCBF algorithm, a popular feature selection algorithm for machine learning with little previous use in biomedical sciences. 

To calculate classical entropies we need categorized data, so we implemented in R a set of heuristics do binarized gene expressions (https://bioconductor.org/packages/release/bioc/html/FCBF.html). 

Additionally, mutual information is a supervised method, meaning that before using it, we need to have labels for cells. 
These labels can be obtained after a standard clustering pipeline, and help to convey information about the distribution of cells in the gene expression manifold. 

Our pipeline, then, uses a binarized gene expression matrix and preliminary labels to select a set of genes that _globally_ separates cells from each other. 

These global markers are not necessarily specific to any cluster; they might be specific to multiple clusters, but still provide information to tell them apart.

The selected features, however, share a degree of redundancy. Some pairs of genes have virtually identical expression patterns. 

FCBF feature selection is good at finding and removing that redundancy, what is good for later classification tasks. 

We decided to take an advantage of this efficiency, and hacked the method: instead of removing genes with redundant patterns, we inverted the process so to identify gene coexpression modules.   

The gene coexpression modules yielded by the default pipeline are small by design (10s of genes per module), so to facilitate manual exploration of the coexpression landscape.
Moreover, each module has one "header" gene, which expression pattern is most representative of the genes in the module. 

The ultimate goatl of the _fcoex_ pipeline, though, is not necessarily the modules, but use them to find biologically relevant populations. As modules contain correlated and anti-correlated genes, instead of 

Re-clustering of cells. fcoex treats each module as a gene set. For each gene set, it re-classifies the cells using only their expression. Modules capture different biological functions, and provide complementary views on cell identities (Figure 1).

![Overview
](https://raw.githubusercontent.com/lubianat/fcoex_report/main/content/images/fcoex_overview.svg?sanitize=true "Vector image"){#fig:vector-image height=2.5in .white}


## fcoex recovers multi-hierarchy of blood types

 To validate the fcoex pipeline, we selected the well-known pbmc3k dataset from SeuratData, which contains around 2700 peripheral blood mononuclear cells (PBMC) with author-defined cluster labels (Figure 2A). 
 The standard fcoex pipeline detected nine modules which, reassureingly, captured transcriptional pathways known to be active in different blood cells (Table A, SUPP FIGURE PBMC 3K). For example, module M8 contained cytotoxicity genes, as PRF1 and GZMA. 
 he reclustering based on M8 split the dataset into cytotoxic (NK + CD8) and non-cytotoxic cells (Figure 2 B-C).
 M7 (CD79A) cluster corresponded to B cells, while M5 (HLA-DRB1) grouped monocytes, B cells, and dendritic cells, all known antigen-presenting cells (APC) (https://www.ebi.ac.uk/ols/ontologies/cl/terms?obo_id=CL:0000145).
 Of note, the APC populations are apart in the UMAP (Uniform Manifold Approximation and Projection for dimensional reduction)(McInnes et al. 2018) representation (Figure 2D), even though the relevance of the class is known acknowledged  similarity might have gone unnoticed in the single-cell analysis without fcoex.
 In general, fcoex clusters are combinations of similar cell types of the original division (Figure 2E), one of which corresponds to a known cell class and the other to the complementary set of cells in the tissue.

<!-- Add figure 1 

Figure 2. Fcoex modules infer PBMC populations with similar functions. a. UMAP visualization of the PBMC dataset b. Module M8, spearheaded by the gene CST7. Nodes represent genes, edges represent correlations by symmetrical uncertainty (see Methods) c. Clustering of the pbmc3k dataset based on the M8 module. d. Clusters derived from modules M5 (HLA-DRB1) and M7 (CD79A) .e. Assignment table showing the percentage of cells in each Seurat cluster that are contained in each seed-positive module. PBMC: á¹”eripheral Blood Mononuclear Cells; SP: Seed Positive; SN: Seed Negative

-->

 ## fcoex uncovers unknown populations in the zebrafish embryo

After the proof of concept, e explored gene-gene interactions in more depth in a gastrulation  dataset of zebrafish cells  (75% epiboly, Figure 3 A)(Farrell et al. 2018). The 10 clusters fed to fcoex, though not corresponding to classic types, fed the algorithm with structure from the gene expression space. Using that structure, fcoex identified 8 modules (using default parameters) and the list of modules is displayed in Table B. 

<!-- Add figure 3 



Fig 3. Clusters highlight the dynamics of zebrafish embryo cells. A: 10 Clusters identified by Seurat in the Schier lab zebrafish dataset for the 75% epiboly stage. B: Different cluster assignments for cells in the dataset based on the genes in 1. C: Genes in the module M2 (SOX19A). D: Expression patterns for the gene APELA and receptors of its product, APLNRB and APLNRA, as well as a downstream factor, MESPAB. E: Model of how the products of the genes above might interact.





-->


The two top ranked modules offer gateways into exploring of zebrafish development biology. 

The top-ranked module M1 (MSGN1) harbored the genes msgn1, tbx16, and tbx6, all related to mesoderm development, a core task of gastrulation. 
In mice, Msgn1 signals via Tbx16(Chalamalasetty et al. 2014) and tbx6l and tbx16 (homologs of Tbx16) play a role together in shaping mesoderm development in zebrafish (Morrow et al. 2017). 
The population described by this module might be of interest for understanding how mesoderm unfolds.  
The second-best modules M2 presented a full pathway - a ligand, apela/Toddler, its receptors, aplnrb, and aplnra, and a putative downstream factor, mespab ((Pauli et al. 2014)(Deshwar et al. 2016). The module contains anticorrelated genes, and the ligand and its receptors are enriched in opposing clusters (TableD, Figure 3C-E).
